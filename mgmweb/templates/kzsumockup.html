<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Testing Snap</title>
        <audio id="kzsu_audio">
            <source src="http://171.66.118.111:18888/kzsu-1-128.mp3">
        </audio>
        <style type="text/css">
            body {
                background-image: radial-gradient(at left, #92bebe, #4EA6A6);
                margin: 0;
            }
        </style>
        <script type="text/javascript" src="{{ url_for('static', filename='snap/snap.svg-min.js') }}"></script>
    </head>
    <body>
    <svg id="heartsvg"></svg>
    <script type="text/javascript">

        var screenwidth = Math.min(window.innerWidth,
            document.documentElement.clientWidth);
        var screenheight = Math.min(window.innerHeight,
            document.documentElement.clientHeight);


        var s = Snap("#heartsvg");
        var entireheart = s.group()
        var background = entireheart.group()
        var banner = s.group();
        var beatingheart = entireheart.group()
        var floatingtext = entireheart.group()
        var listengroup = floatingtext.group()

        var t = new Snap.Matrix();
            t.translate(0,70);
            entireheart.transform(t,500);

        var starburst = Snap.load("{{ url_for('static', filename='starburst.svg') }}", function ( loadedFragment ) {
            background.append( loadedFragment );
            var t = new Snap.Matrix();
            t.translate(-140,-50);
            background.transform(t,500);
            //setInterval(spin, 0);
        });

        banner.rect(0,50,screenwidth,50)
        var logogroup = banner.group()

        var kzsulogo = Snap.load("{{ url_for('static', filename='minimal_logo_white.svg') }}", function ( loadedFragment ) {
            logogroup.append( loadedFragment );
            var t = new Snap.Matrix().scale(0.07).translate(250,660);
            logogroup.transform(t,.500);
            //setInterval(spin, 0);
            //beatingheart.mouseover(hoverover);
            //beatingheart.mouseout(hoverout);
            //beatingheart.click(CLICK);
            //setInterval(beat, 1800);
        });


        var heart = Snap.load("{{ url_for('static', filename='plain_heart.svg') }}", function ( loadedFragment ) {
            beatingheart.append( loadedFragment );
            var t = new Snap.Matrix();
            t.translate(100,100);
            beatingheart.transform(t,500);
            beatingheart.mouseover(hoverover);
            beatingheart.mouseout(hoverout);
            beatingheart.click(CLICK);
            setInterval(beat, 1800);
        });

        var listen = Snap.load("{{ url_for('static', filename='listen.svg') }}", function ( loadedFragment ) {
            listengroup.append( loadedFragment );
            var t = new Snap.Matrix();
            t.translate(135,280);
            listengroup.transform(t,500);
            listengroup.attr({ style: "pointer-events: none" });
        });

        var play = s.path(Snap.format("M 190,335 v 100 l 100,-50 z"));

        play.attr({fill:'white'});
        play.attr({style: "pointer-events: none" });
        play.attr({opacity: 0});

        var hoverover = function(){
            listengroup.attr({opacity: 0});
            play.attr({opacity: 1});
        };

        var hoverout = function(){
            listengroup.attr({opacity: 1});
            play.attr({opacity: 0});
        };
        
        var beat = function(){
            beatingheart.animate({ transform: 's.95,250,300,t100,100' }, 50, function(){
                beatingheart.animate({ transform: 's1.1,250,300,t100,100' }, 50, function(){
                    beatingheart.animate({ transform: 's1,250,300,t100,100'}, 200);
                });
            });
        };

       /* var spin = function(){
            background.animate({ transform: 'r1000'}, 80000);
        }*/

        var CLICK = function(){
            play.attr({fill: "aquamarine"});
            console.log("click");
            document.getElementById('kzsu_audio').play();
        }
    </script>
    </body>
</html>
